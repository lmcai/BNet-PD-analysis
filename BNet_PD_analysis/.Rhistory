View(mm)
mm <- melt(x$V3)
a=cbind(z$3,x$V3)
a=cbind(z$V3,x$V3)
View(a)
mm <- melt(a)
View(mm)
p <- ggplot(mm, aes(x=variable, y=value, fill=variable)) +
geom_violin(fill='gray')+
labs(x="Species tree discordance", y = "Pairwise RF distance")
p + geom_boxplot(width=0.1,fill='white') + theme_classic()
p <- ggplot(mm, aes(x=X2, y=value, fill=variable)) +
geom_violin(fill='gray')+
labs(x="Species tree discordance", y = "Pairwise RF distance")
p + geom_boxplot(width=0.1,fill='white') + theme_classic()
p <- ggplot(mm, aes(x=X2, y=value, fill=X2)) +
geom_violin(fill='gray')+
labs(x="Species tree discordance", y = "Pairwise RF distance")
p + geom_boxplot(width=0.1,fill='white') + theme_classic()
x=read.csv('../FigS2a_GeneTrBP_SiteSubsample.csv')
x=read.csv('../../FigS2a_GeneTrBP_SiteSubsample.csv')
x=read.csv('/Users/lcai/Dropbox/Cai_etal_2018_malpighiales_ILS/Bookkeeping/FigS2//FigS2a_GeneTrBP_SiteSubsample.csv')
mm <- melt(x)
x=read.table('/Users/lcai/Dropbox/Cai_etal_2018_malpighiales_ILS/Bookkeeping/FigS2/FigS2d_RFdistance_flankingregion/RAxML_RF-Distances.ExonIntron')
boxplot(x$V3,y$V3,z$V3)
boxplot(z$V3,y$V3,x$V3)
boxplot(z$V3,y$V3,x$V3,xlab='Species tree discordance',ylab='Pairwise RF distance')
a=read.csv('/Users/lcai/Dropbox/Cai_etal_2018_malpighiales_ILS/Bookkeeping/FigS2/FigS2d_RFdistance_flankingregion/FigS2d_pairwiseRF.csv')
View(a)
mm <- melt(a)
View(mm)
p <- ggplot(mm, aes(x=X2, y=value, fill=X2)) +
geom_violin(fill='gray')+
labs(x="Species tree discordance", y = "Pairwise RF distance")
p + geom_boxplot(width=0.1,fill='white') + theme_classic()
p <- ggplot(mm, aes(x=variable, y=value, fill=variable)) +
geom_violin(fill='gray')+
labs(x="Species tree discordance", y = "Pairwise RF distance")
p + geom_boxplot(width=0.1,fill='white') + theme_classic()
ggsave("~/Desktop/FigS2d.pdf", width = 2.5, height = 2.5)
q()
install.packages("phytools")
library(phytools)
tree=read.tree(text='((((((((((Sap:83.638900,(Jat:49.405722,Mes:49.405722):34.233179):2.033813,Ptr:85.672713):13.603811,((Ath:89.560313,Gos:89.560313):6.439687,Cit:96.000000):3.276524):4.085367,(Gly:92.693460,Pru:92.693460):10.668432):6.261996,Vvi:109.623888):3.315787,((((Cof:86.152907,((Ipo:39.204773,Cus:39.204773):32.747671,(Nic:22.593687,Sol:22.593687):49.358757):14.200463):3.643976,(((Han:46.110747,(Mim:43.139598,(Pht:34.452780,Str:34.452780):8.686818):2.971149):1.690287,Ses:47.801035):21.822753,Ole:69.623788):20.173095):10.752537,(Dau:90.511140,Hel:90.511140):10.038280):4.608575,Act:105.157995):7.781679):12.949427,Nel:125.889102):3.720799,Aqu:129.609901):20.571711,Osa:150.181612):43.818388,Amb:194.000000);')
x<-as.matrix(read.csv("/Users/lcai/Dropbox/Sapria/HGT/HGT.phylo_frequency",row.names=1))[,1]
x<-as.matrix(read.table("/Users/lcai/Dropbox/Sapria/HGT/HGT.phylo_frequency",row.names=1))[,1]
dotTree(tree,x,length=10,ftype="i")
x[0:1]
x=read.table('~/Dropbox/Sapria/VGT.stem_crown_br_len_distr.tsv',sep = '\t',header = T)
plot(x$stem_gr_len,x$stem_gr_len=x$crown2sap_len)
plot(x$stem_gr_len,x$stem_gr_len+x$crown2sap_len)
plot(x$stem_gr_len,x$stem_gr_len+x$crown2sap_len,pch=20,cex=0.4)
plot(x$stem_gr_len,x$stem_gr_len+x$crown2sap_len,pch=20,cex=0.4,xlim = c(0,4),ylim = c(0,8))
plot(x$stem_gr_len,x$stem_gr_len+x$crown2sap_len,pch=20,cex=0.4,xlim = c(0,2),ylim = c(0,4))
plot(x$stem_gr_len,x$stem_gr_len+x$crown2raf_len,pch=20,cex=0.4,xlim = c(0,2),ylim = c(0,4))
hist(x$stem_gr_len/x$crown2raf_len)
hist(x$stem_gr_len/x$crown2raf_len,xlim = c(0,10))
a=x$stem_gr_len/x$crown2raf_len
a=a[a<10]
hist(a)
hist(a,breaks=30)
hist(a,breaks=50)
median(a[a<1.2])
115/(1.48)
95/(1.48)
a=x$stem_gr_len/x$crown2rhi_len
a=a[a<10]
hist(a)
hist(a,breaks=50)
median(a[a<1.2])
abline(x=y,col='red')
abline(xa=0,b=1,col='red')
abline(a=0,b=1,col='red')
abline(a=0,b=2,col='red')
abline(a=0.5,b=2,col='red')
abline(a=0.5,b=1.5,col='red')
abline(a=0.5,b=1.2,col='red')
z=x[(x$stem_gr_len+x$crown2raf_len)>x$stem_gr_len*1.2+0.5 & x$stem_gr_len>0.25,]
write.csv(z,'test.csv')
plot(x$stem_gr_len,x$stem_gr_len+x$crown2sap_len,pch=20,cex=0.4,xlim = c(0,2),ylim = c(0,4))
abline(a=0.8,b=1.2,col='red')
abline(a=0.8,b=1.1,col='red')
abline(a=0.8,b=1,col='red')
abline(a=0.7,b=1,col='red')
z1=x[(x$stem_gr_len+x$crown2sap_len)>x$stem_gr_len*1+0.7 & x$stem_gr_len>0.25,]
write.csv(z,'sap.relaxed.csv')
write.csv(z1,'sap.relaxed.csv')
plot(x$stem_gr_len,x$stem_gr_len+x$crown2rhi_len,pch=20,cex=0.4,xlim = c(0,2),ylim = c(0,4))
abline(a=0.7,b=1,col='red')
abline(a=0.5,b=1,col='red')
abline(a=0.5,b=1.2,col='red')
z2=x[(x$stem_gr_len+x$crown2rhi_len)>x$stem_gr_len*1.2+0.5 & x$stem_gr_len>0.25,]
write.csv(z2,'rhi.relaxed.csv')
q()
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DOSE")
library(dose)
library(DOSE)
data(geneList)
de <- names(geneList)[abs(geneList) > 2]
edo <- enrichDGN(de)
p1 <- emapplot(edo)
p2 <- emapplot(edo, pie_scale=1.5)
p3 <- emapplot(edo,layout="kk")
p4 <- emapplot(edo, pie_scale=1.5,layout="kk")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("enrichplot")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("enrichplot")
install.packages("ggrepel")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("clusterProfiler")
library(clusterProfiler)
install.packages("ggrepel")
library(clusterProfiler)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("enrichplot")
library(enrichplot)
p1 <- emapplot(edo)
p2 <- emapplot(edo, pie_scale=1.5)
p3 <- emapplot(edo,layout="kk")
p4 <- emapplot(edo, pie_scale=1.5,layout="kk")
View(p2)
cowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4])
cowplot::plot_grid(p1)
View(edo)
browseVignettes("clusterProfiler")
data(geneList, package="DOSE")
gene <- names(geneList)[abs(geneList) > 2]
a=read.csv('~/Dropbox/Sapria/Gene loss/ShinyGO_and_PlantRegMap/Ath.orthofinderLoss.txt')
a=read.csv('~/Dropbox/Sapria/Gene loss/ShinyGO_and_PlantRegMap/Ath.orthofinderLoss.txt',header = F)
gene=as.vector(a$V1)
b=read.csv('~/Dropbox/Sapria/Gene loss/ShinyGO_and_PlantRegMap/Ath.orthofinderBackground.txt',header = F)
backgr=as.vector(b$V1)
?enrichGO
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db, ont='ALL', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable      = TRUE)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb ='org.At.tair.db', ont='ALL', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable      = TRUE)
data(geneList, package="DOSE")
gene <- names(geneList)[abs(geneList) > 2]
gene.df <- bitr(gene, fromType = "ENTREZID",
toType = c("ENSEMBL", "SYMBOL"),
OrgDb = org.Hs.eg.db)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("org.At.eg.db")
version
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("org.At.tair.db")
gene=as.vector(a$V1)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db, ont='ALL', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable= TRUE)
library(org.At.tair.db)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db, ont='ALL', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable= TRUE)
ego
groupGO(gene = gene,OrgDb    = org.At.tair.db, ont      = "CC",level=3,readable = T)
?groupGO
groupGO(gene = gene,OrgDb    = org.At.tair.db, ont      = "CC",level=3,readable = T,keyType = 'ENSEMBL')
groupGO(gene = gene,OrgDb    = org.At.tair.db, ont      = "CC",level=3,readable = T,keyType = 'UNIPROT')
groupGO(gene = gene,OrgDb    = org.At.tair.db, ont      = "CC",level=3,readable = T,keyType = 'ENTREZID')
keytypes(org.At.tair.db)
groupGO(gene = gene,OrgDb    = org.At.tair.db, ont      = "CC",level=3,readable = T,keyType = 'TAIR')
ggo<-groupGO(gene = gene,OrgDb    = org.At.tair.db, ont      = "CC",level=3,readable = T,keyType = 'TAIR')
ggo
head(ggo)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db,keytype='TAIR', ont='ALL', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable= TRUE)
?enrichGO
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db,keyType='TAIR', ont='ALL', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable= TRUE)
head(ego)
library(enrichplot)
barplot(ego, showCategory=20)
dotplot(ego,showCategory=30)
egox <- setReadable(ego, 'org.At.tair.db', 'TAIR')
cnetplot(egox, categorySize="pvalue")
emapplot(ego)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db,keyType='TAIR', ont='BP', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.05,readable= TRUE)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db,keyType='TAIR', ont='BP', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.01,readable= TRUE)
emapplot(ego)
View(ego)
emapplot(ego,layout = 'kk')
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db,keyType='TAIR', ont='BP', pAdjustMethod = "BH",pvalueCutoff  = 0.05,qvalueCutoff  = 0.05,readable= TRUE)
emapplot(ego,layout = 'kk')
emapplot(ego,layout = 'kk',showCategory = 100)
emapplot(ego,layout = 'kk',showCategory = 500)
ego <- enrichGO(gene=gene,universe=backgr,OrgDb =org.At.tair.db,keyType='TAIR', ont='BP', pAdjustMethod = "BH",pvalueCutoff  = 0.01,qvalueCutoff  = 0.01,readable= TRUE)
emapplot(ego,layout = 'kk',showCategory = 500)
?emapplot
emapplot(ego,layout = 'kk',showCategory = 500, pie_scale=1)
emapplot(ego,layout = 'kk',showCategory = 500, pie_scale=0.7)
pdf('test.pdf',width = 10,height = 12)
emapplot(ego,layout = 'kk',showCategory = 500, pie_scale=0.7)
dev.off()
pdf('test.pdf',width = 20,height = 24)
emapplot(ego,layout = 'kk',showCategory = 500, pie_scale=0.7)
dev.off()
ego_reduced <- simplify(ego, cutoff=0.7, by="p.adjust", select_fun=min)
emapplot(ego,layout = 'kk',showCategory = 500, pie_scale=0.7)
ego_reduced <- simplify(ego, cutoff=0.5, by="p.adjust", select_fun=min)
x=read.csv('~/Downloads/rnd1.cds2genome.intron',header = F
)
plot(density(log(x$V1,10)))
x=read.csv('~/Downloads/rnd1_rerun.est2genome.intron',header = F
)
plot(density(log(x$V1,10)))
library(phybase)
install.packages("phybase")
library(ape)
y=read.tree('~/Dropbox/ExaML_result.final3.ML')
z=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/ID_Sp.csv')
z$ID=as.character(z$ID)
u=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/malpighiaceaedatabaseexports/Malpighiaceae_DNA_Liming.csv',header=F)
for (i in 1:length(y$tip.label)){
a=0
b=list()
a=strsplit(y$tip.label[i],'[.]')
b=which(z$ID==a[[1]][1])
if (length(b)>0){
y$tip.label[i]=paste(z$genus[b],z$sp[b],y$tip.label[i],sep='_')
}else{
b=which(u$V1==a[[1]][1])
y$tip.label[i]=paste(u$V2[b],u$V3[b],y$tip.label[i],sep='_')
}
}
write.tree(y,'~/Downloads/ITS.final3.spname.tre')
y=read.tree('~/Dropbox/ExaML_result.final3.ML')
z=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/ID_Sp.csv')
z$ID=as.character(z$ID)
u=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/malpighiaceaedatabaseexports/Malpighiaceae_DNA_Liming.csv',header=F)
for (i in 1:length(y$tip.label)){
a=0
b=list()
a=strsplit(y$tip.label[i],'[.]')
b=which(z$ID==a[[1]][1])
if (length(b)>0){
y$tip.label[i]=paste(z$genus[b],z$sp[b],y$tip.label[i],sep='_')
}else{
b=which(u$V1==a[[1]][1])
y$tip.label[i]=paste(u$V2[b],u$V3[b],y$tip.label[i],sep='_')
}
}
write.tree(y,'~/Downloads/ITS.final3_rnd2.spname.tre')
y=read.tree('~/Dropbox/Malpighiaceae_plastome_phylogeny/ITS/final3.rnd2.35S_ETS.lib12_nopolyphyletic.ordered.elatinaceae.partition.treefile')
z=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/ID_Sp.csv')
z$ID=as.character(z$ID)
u=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/malpighiaceaedatabaseexports/Malpighiaceae_DNA_Liming.csv',header=F)
for (i in 1:length(y$tip.label)){
a=0
b=list()
a=strsplit(y$tip.label[i],'[.]')
b=which(z$ID==a[[1]][1])
if (length(b)>0){
y$tip.label[i]=paste(z$genus[b],z$sp[b],y$tip.label[i],sep='_')
}else{
b=which(u$V1==a[[1]][1])
y$tip.label[i]=paste(u$V2[b],u$V3[b],y$tip.label[i],sep='_')
}
}
write.tree(y,'ITS.final3.spname.tre')
y=read.tree('~/Dropbox/Malpighiaceae_plastome_phylogeny/ITS/final3.rnd2.35S_ETS.lib12_nopolyphyletic.ordered.elatinaceae.partition.treefile')
z=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/ID_Sp.csv')
z$ID=as.character(z$ID)
u=read.csv('/Users/lcai/Downloads/Malpighiaceae_Chl/malpighiaceaedatabaseexports/Malpighiaceae_DNA_Liming.csv',header=F)
for (i in 1:length(y$tip.label)){
a=0
b=list()
a=strsplit(y$tip.label[i],'[.]')
b=which(z$ID==a[[1]][1])
if (length(b)>0){
y$tip.label[i]=paste(z$genus[b],z$sp[b],y$tip.label[i],sep='_')
}else{
b=which(u$V1==a[[1]][1])
y$tip.label[i]=paste(u$V2[b],u$V3[b],y$tip.label[i],sep='_')
}
}
write.tree(y,'~/Downloads/ITS.final3_rnd3.spname.tre')
64*63*62*61/2/3/4
64*63*62/2/3
q()
0.05/30856
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("IRanges")
devtools::install_github("vanOosterhoutLab/HybridCheck", build_vignettes = TRUE)
BiocManager::install("Biostrings")
devtools::install_github("vanOosterhoutLab/HybridCheck", build_vignettes = TRUE)
R
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.11")
library(ape)
x=read.nexus('~/Downloads/RESULT.labeled.tre.figtree.nex')
plot(x)
plot(x,show.node.label = T)
plot(x,show.node.label = T,use.edge.length = F)
library(ggplot2)
library(ggtree)
library(ape)
setwd('Documents/GitHub/BNet-PD-analysis/BNet_PD_analysis/')
tree=read.nexus('tree7_AA_150tree_all_dated_summary_renamed.tre')
heatmapData=read.table("results_sum_new_mpd_mntd.tsv", sep='\t',header = T)
rn <- rownames(heatmapData)
heatmapData <- as.data.frame(sapply(heatmapData, as.character))
rownames(heatmapData) <- rn
rn <- rownames(heatmapData[,1])
heatmapData <- as.data.frame(sapply(heatmapData, as.character))
rownames(heatmapData) <- rn
heatmapData=read.table("results_sum_new_mpd_mntd.tsv", sep='\t',header = T)
rn <- rownames(heatmapData[,1])
heatmapData <- as.data.frame(sapply(heatmapData, as.character))
rownames(heatmapData) <- rn
rn <- heatmapData[,1]
rn <- heatmapData[,1]
rn <- list(heatmapData[,1])
View(rn)
heatmapData=read.table("results_sum_new_mpd_mntd.tsv", sep='\t',header = T)
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")
+geom_cladelabel(node=45, label="test label")
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+geom_cladelabel(node=45, label="test label")
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+geom_strip(5, 7, barsize=2, color='red')
?geom_strip
which(tree$tip.label=='BN000389_MY2016HES78_Hesperiidae_Coeliadinae_X_Hasora_chromus_chromus')
which(tree$tip.label=='08SNRP1153_X_Hesperiidae_Hesperiinae_Hesperiini_Anthoptus_sp_X_ME')
tree$tip.label[1]
tree$tip.label[3]
tree$tip.label[4]
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=4, color='grey', offset.text = 1,label='Hesperiinae')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=4, offset.text = 1,label='Hesperiinae')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=20, offset.text = 1,label='Hesperiinae')
which(tree$tip.label=='GCA9001994451_X_Pieridae_Dismorphiinae_X_Leptidea_sinapis')
which(tree$tip.label=='BN002292_LEP35444_Pieridae_Pierinae_Pierini_Belenois_subeida')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=20, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=20, offset.text = 5,label='Pieridae')
which(tree$tip.label=='BN005748_LEP13577_Nymphalidae_Libytheinae_X_Libythea_celtis')
which(tree$tip.label=='BN002155_LEP32873_Nymphalidae_Danainae_Ithomiini_Tithorea_tarricina')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
#geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(558, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
)
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
#geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(558, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')
which(tree$tip.label=='AJG07N837_X_Nymphalidae_Satyrinae_Dirini_Aeropetes_tulbaghia_X_ME')
which(tree$tip.label=='BN004020_RE02A145_Lycaenidae_Curetinae_X_Curetis_saronis')
which(tree$tip.label=='AJG07E194_X_Lycaenidae_Theclinae_Cheritrini_Dapidodigma_demeter_X_ME')
which(tree$tip.label=='BN002738_LEP44530_Riodinidae_Nemeobiinae_Euselasiini_Hades_noctula')
which(tree$tip.label=='04SRNP12667_X_Riodinidae_Riodininae_Nymphidiini_Theope_virgilius_X_ME')
which(tree$tip.label=='BN007182_LEP45956_Papilionidae_Parnassiinae_Parnassiini_Parnassius_apollo')
which(tree$tip.label=='BN002196_LEP32867_Papilionidae_Papilioninae_Troidini_Atrophaneura_semperi')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800),guide = "colourbar")+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
?scale_color_continuous
?guides
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800))+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')+
guides(colour = guide_colourbar())
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="red", limits=c(325, 800),oob=scales::squish)+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')+
guides(colour = guide_colourbar())
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(PD)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="yellow", limits=c(325, 800),oob=scales::squish)+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=PD),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="yellow", limits=c(325, 800),oob=scales::squish)+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
pdf('PD_circular_tree.pdf',width = 15,height = 15)
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=PD),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='PD',low="blue", high="yellow", limits=c(325, 800),oob=scales::squish)+
labs(title = "PD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
dev.off()
pdf('MPD_circular_tree.pdf',width = 15,height = 15)
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(mpd.obs)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='mpd.obs',low="blue", high="yellow")+
labs(title = "MPD")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
dev.off()
pdf('DSI_circular_tree.pdf',width = 15,height = 15)
ggtree(tree, ladderize = F, layout='circular') %<+% heatmapData +
geom_tippoint(aes(color=as.numeric(mpd.obs.z)),size=0.5) +
geom_tiplab2(aes(label=Lep_accepted_name), align=T, linetype=NA, offset=8, hjust=0.5, size = 0.5) +
scale_color_continuous(name='mpd.obs.z',low="blue", high="yellow")+
labs(title = "DSI")+
geom_strip(2, 131, barsize=3, color='grey', offset=30, offset.text = 5,label='Hesperiinae')+
geom_strip(578, 1755, barsize=3, color='grey', offset=30, offset.text = 5,label='Pieridae')+
geom_strip(5, 1014, barsize=3, color='grey', offset=30, offset.text = 5,label='Lycaenidae')+
geom_strip(6, 1368, barsize=3, color='grey', offset=30, offset.text = 5,label='Nymphalidae')+
geom_strip(637, 1, barsize=3, color='grey', offset=30, offset.text = 5,label='Riodinidae')+
geom_strip(1683, 564, barsize=3, color='grey', offset=30, offset.text = 5,label='Papilionidae')
dev.off()
